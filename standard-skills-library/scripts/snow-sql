#!/usr/bin/env bash
# Execute SQL against Snowflake via the snow CLI.
# Usage: snow-sql "SELECT 1" [-c connection] [--role ROLE] [--warehouse WH]
#
# Wraps `snow sql` with sensible defaults:
#   - JSON output for structured parsing
#   - Passes all extra flags through to snow sql
#
# Examples:
#   snow-sql "SELECT CURRENT_ROLE()"
#   snow-sql "SHOW TABLES IN SCHEMA mydb.myschema" -c myconn
#   snow-sql "SELECT * FROM t LIMIT 10" -c myconn --role ANALYST

set -euo pipefail

if [[ $# -lt 1 ]]; then
  echo "Usage: snow-sql \"SQL QUERY\" [-c connection] [--role ROLE] [--warehouse WH]" >&2
  exit 1
fi

SQL="$1"
shift

exec snow sql -q "$SQL" "$@"
