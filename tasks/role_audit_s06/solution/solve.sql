USE ROLE {admin_role};
USE WAREHOUSE {warehouse};

CREATE OR REPLACE VIEW {database}.{analytics_schema}.ROLE_GRANT_AUDIT AS
SELECT
    GRANTEE_NAME,
    PRIVILEGE,
    GRANTED_ON,
    NAME AS OBJECT_NAME,
    GRANTED_BY,
    CREATED_ON
FROM SNOWFLAKE.ACCOUNT_USAGE.GRANTS_TO_ROLES
WHERE DELETED_ON IS NULL
ORDER BY GRANTEE_NAME, GRANTED_ON;
