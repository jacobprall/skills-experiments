task_id: resource_monitor_010
status: ready
difficulty: simple
category: admin
domains: [cost-management]
description: Create a resource monitor with credit quota and triggers.
environment: support_tickets

steps:
  - step_id: 1
    type: prompt
    prompt: >
      Create a resource monitor called {raw_schema}_MONITOR with a monthly credit
      quota of 100. Add triggers: notify at 75%, suspend at 90%, immediately
      suspend at 100%.

requirements:
  - id: monitor_exists
    description: Resource monitor exists.
    check: sql
    query: |
      SHOW RESOURCE MONITORS LIKE '{raw_schema}_MONITOR';
      SELECT COUNT(*) AS ct FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
    pass_if: ct > 0

assertions:
  - id: credit_quota
    category: cost
    type: sql
    points: 2
    query: |
      SHOW RESOURCE MONITORS LIKE '{raw_schema}_MONITOR';
      SELECT "credit_quota" AS val FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
    check: val = 100
    description: Credit quota set to 100

traps: []
solution:
  scripts: [solve.sql]
