task_id: clone_schema_014
status: ready
difficulty: simple
category: admin
domains: [data-engineering]
description: Create a zero-copy clone of the raw schema for testing.
environment: support_tickets

steps:
  - step_id: 1
    type: prompt
    prompt: >
      Create a zero-copy clone of {database}.{raw_schema} called
      {database}.{staging_schema}_CLONE for testing purposes.

requirements:
  - id: clone_exists
    description: Clone schema was created.
    check: sql
    query: |
      SELECT COUNT(*) AS ct FROM {database}.INFORMATION_SCHEMA.SCHEMATA
      WHERE SCHEMA_NAME = '{staging_schema}_CLONE'
    pass_if: ct > 0

assertions:
  - id: clone_has_tables
    category: correctness
    type: sql
    points: 2
    query: |
      SELECT COUNT(*) AS ct FROM {database}.INFORMATION_SCHEMA.TABLES
      WHERE TABLE_SCHEMA = '{staging_schema}_CLONE'
    check: ct > 0
    description: Clone contains tables from source

traps: []
solution:
  scripts: [solve.sql]
